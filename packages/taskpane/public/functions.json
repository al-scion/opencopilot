{
  "$schema": "https://developer.microsoft.com/json-schemas/office-js/custom-functions.schema.json",
  "allowCustomDataForDataTypeAny": true,
  "allowErrorForDataTypeAny": true,
  "functions": [
    {
      "id": "GENERATE.TEXT",
      "name": "GENERATE.TEXT",
      "description": "Generate text with AI",
      "helpUrl": "https://docs.usevariant.com/functions/text",
      "options": {
        "stream": true
      },
      "parameters": [
        {
          "name": "instruction",
          "description": "Insert instruction here",
          "type": "string"
        },
        {
          "name": "model",
          "description": "The model to use for generating the text",
          "optional": true,
          "type": "string",
          "customEnumType": "LANGUAGE_MODELS"
        }
      ],
      "result": {}
    },
    {
      "id": "GENERATE.IMAGE",
      "name": "GENERATE.IMAGE",
      "description": "Generate an image with AI",
      "helpUrl": "https://docs.usevariant.com/functions/image",
      "options": {
        "cancelable": true
      },
      "parameters": [
        {
          "name": "instruction",
          "description": "The instruction to generate an image for",
          "type": "string"
        },
        {
          "name": "reference_image",
          "description": "The references to use for generating the image",
          "dimensionality": "matrix",
          "optional": true
        },
        {
          "name": "model",
          "optional": true,
          "type": "string"
        }
      ],
      "result": {}
    },
    {
      "id": "GENERATE.CHART",
      "name": "GENERATE.CHART",
      "description": "Generate a chart with AI",
      "helpUrl": "https://docs.usevariant.com/functions/chart",
      "options": {},
      "parameters": [],
      "result": {}
    },
    {
      "id": "GENERATE.LIST",
      "name": "GENERATE.LIST",
      "description": "Generate a list of results",
      "helpUrl": "https://docs.usevariant.com/functions/list",
      "options": {
        "stream": true
      },
      "parameters": [
        {
          "name": "instruction",
          "description": "The instruction to generate a list of results for",
          "type": "string"
        },
        {
          "name": "number_of_results",
          "description": "The number of results to generate. Default is 5",
          "type": "number",
          "optional": true
        }
      ],
      "result": {
        "dimensionality": "matrix"
      }
    },
    {
      "id": "TOOL.SANDBOX",
      "name": "TOOL.SANDBOX",
      "description": "Run code in a sandbox",
      "helpUrl": "https://docs.usevariant.com/functions/sandbox",
      "options": {
        "cancelable": true
      },
      "parameters": [
        {
          "name": "code",
          "type": "string"
        }
      ],
      "result": {}
    },
    {
      "id": "TOOL.CLASSIFY",
      "name": "TOOL.CLASSIFY",
      "description": "Classify data into provided options",
      "helpUrl": "https://docs.usevariant.com/functions/classify",
      "options": {
        "stream": true
      },
      "parameters": [
        {
          "name": "reference",
          "description": "The reference input data to be classified. Can be a single cell or a range of cells",
          "dimensionality": "matrix"
        },
        {
          "name": "options",
          "description": "The options to classify the data",
          "type": "string",
          "dimensionality": "matrix"
        },
        {
          "name": "instruction",
          "description": "Add specific instructions to help with classifying the data",
          "type": "string",
          "optional": true
        }
      ],
      "result": {
        "dimensionality": "matrix"
      }
    },
    {
      "id": "TOOL.ENRICH",
      "name": "TOOL.ENRICH",
      "description": "Enrich a table with AI",
      "helpUrl": "https://docs.usevariant.com/functions/table",
      "options": {
        "stream": true
      },
      "parameters": [
        {
          "name": "header_row",
          "description": "The first row of the table",
          "type": "string",
          "dimensionality": "matrix"
        },
        {
          "name": "column_headers",
          "description": "The first column of the table",
          "type": "string",
          "dimensionality": "matrix"
        },
        {
          "name": "instruction",
          "description": "Add specific instructions to help with enriching the table",
          "type": "string",
          "optional": true
        }
      ],
      "result": {
        "dimensionality": "matrix"
      }
    },
    {
      "id": "TOOL.EXTRACT",
      "name": "TOOL.EXTRACT",
      "description": "Extract data from a file",
      "helpUrl": "https://docs.usevariant.com/functions/extract",
      "options": {
        "stream": true,
        "capturesCallingObject": true
      },
      "parameters": [
        {
          "name": "file_reference",
          "description": "Reference to the file object"
        },
        {
          "name": "instruction",
          "description": "Add specific instructions to help with extracting the data",
          "type": "string"
        }
      ],
      "result": {
        "dimensionality": "matrix"
      }
    },
    {
      "id": "TOOL.SCRAPE",
      "name": "TOOL.SCRAPE",
      "description": "Scrape the contents of a website",
      "helpUrl": "https://docs.usevariant.com/functions/scrape",
      "options": {
        "stream": true
      },
      "parameters": [
        {
          "name": "url",
          "description": "The URL to scrape",
          "type": "string"
        },
        {
          "name": "instruction",
          "description": "Add specific instructions to help with extracting the data",
          "type": "string"
        }
      ],
      "result": {
        "dimensionality": "matrix"
      }
    }
  ],
  "enums": [
    {
      "id": "LANGUAGE_MODELS",
      "type": "string",
      "values": [
        {
          "name": "Gemini 3 Flash (default)",
          "value": "google/gemini-3-flash"
        },
        {
          "name": "Gemini 3 Pro",
          "value": "google/gemini-3-pro"
        },
        {
          "name": "Sonnet 4.5",
          "value": "anthropic/claude-sonnet-4.5"
        },
        {
          "name": "Opus 4.5",
          "value": "anthropic/claude-opus-4.5"
        },
        {
          "name": "GPT 5.2",
          "value": "openai/gpt-5.2"
        }
      ]
    }
  ]
}
